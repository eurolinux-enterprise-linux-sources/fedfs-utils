.\"@(#)fedfs-create-replication.8"
.\"
.\" @file doc/man/fedfs-create-replication.8
.\" @brief man page for fedfs-create-replication client command
.\"

.\"
.\" Copyright 2011, 2013 Oracle.  All rights reserved.
.\"
.\" This file is part of fedfs-utils.
.\"
.\" fedfs-utils is free software; you can redistribute it and/or modify
.\" it under the terms of the GNU General Public License version 2.0 as
.\" published by the Free Software Foundation.
.\"
.\" fedfs-utils is distributed in the hope that it will be useful, but
.\" WITHOUT ANY WARRANTY; without even the implied warranty of
.\" MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
.\" GNU General Public License version 2.0 for more details.
.\"
.\" You should have received a copy of the GNU General Public License
.\" version 2.0 along with fedfs-utils.  If not, see:
.\"
.\"	http://www.gnu.org/licenses/old-licenses/gpl-2.0.txt
.\"
.TH FEDFS-CREATE-REPLICATION 8 "@pubdate@"
.SH NAME
fedfs-create-replication \- send a FEDFS_CREATE_REPLICATION ADMIN protocol request
.SH SYNOPSIS
.B fedfs-create-replication
.RB [ \-?d ]
.RB [ \-n
.IR nettype ]
.RB [ \-h
.IR hostname ]
.RB [ \-l
.IR nsdbname ]
.RB [ \-r
.IR nsdbport ]
.RB [ \-s
.IR security ]
.I path
.I uuid
.SH INTRODUCTION
RFC 5716 introduces the Federated File System (FedFS, for short).
FedFS is an extensible standardized mechanism
by which system administrators construct
a coherent namespace across multiple file servers using
.IR "file system referrals" .
For further details, see
.BR fedfs (7).
.P
FedFS-enabled file servers allow remote administrative access via an
authenticated RPC protocol known as the
.IR "FedFS ADMIN protocol" .
Using this protocol, FedFS administrators manage
FedFS junctions and NSDB connection parameter information
on remote FedFS-enabled file servers.
.SH DESCRIPTION
The
.BR fedfs-create-replication (8)
command is part of a collection of low-level single-use programs
that is intended for testing the FedFS ADMIN protocol or for use in scripts.
It sends a single FEDFS_CREATE_REPLICATION request to a remote
FedFS ADMIN protocol service.
.P
The FEDFS_CREATE_REPLICATION request creates a replication marker
in a local file system on a remote file server.
The contents of a replication marker are an UUID and an NSDB name and port.
.P
The
.BR fedfs-create-replication (8)
command takes two positional parameters which specify
the pathname on the remote server of the replication, and an UUID.
This pathname is relative to the roo
of the local file system on the remote server.
Required NSDB information can be inferred
from the command's environment or specified on the command line.
The meaning of these arguments is described in more detail in
.BR fedfs (7).
.SH OPTIONS
.IP "\fB\-d, \-\-debug"
Enables debugging messages during operation.
.IP "\fB\-?, \-\-help"
Displays
.BR fedfs-create-replication (8)
version information and a usage message on
.IR stderr .
.IP "\fB\-h, \-\-hostname=\fIhostname\fP"
Specifies the hostname of a remote FedFS ADMIN service.
If this option is not specified, the default value is
.BR localhost .
.IP "\fB\-n, \-\-nettype=\fInettype\fP"
Specifies the transport to use when contacting the remote FedFS ADMIN service.
Typically the
.I nettype
is one of
.B tcp
or
.BR udp .
If this option is not specified, the default value is
.BR netpath .
See
.BR rpc (3t)
for details.
.IP "\fB\-l, \-\-nsdbname=\fINSDB-hostname\fP"
Specifies the hostname of the NSDB to insert into the new FedFS replication.
If this option is not specified,
the value of the FEDFS_NSDB_HOST environment variable is consulted.
If the variable is not set and the
.B --nsdbname
option is not specified, the
.BR fedfs-create-replication (8)
command fails.
.IP "\fB\-r, \-\-nsdbport=\fINSDB-port\fP"
Specifies the IP port of the NSDB to insert into the new FedFS replication.
If this option is not specified,
the value of the FEDFS_NSDB_PORT environment variable is consulted.
The default value if the variable is not set is 389.
.IP "\fB\-s, \-\-security=\fIflavor\fP"
Specifies the security flavor to use
when contacting the remote FedFS ADMIN service.
Valid flavors are
.BR sys ,
.BR unix ,
.BR krb5 ,
.BR krb5i ", and"
.BR krb5p .
If this option is not specified, the
.B unix
flavor is used.
See the
.B SECURITY
section of this man page for details.
.SH EXAMPLES
Suppose you are the FedFS administrator of the
.I example.net
FedFS domain and that your domain's NSDB hostname is
.IR nsdb.example.net .
To create a new FedFS replication on the file server
.IR fs.example.net ,
use:
.RS
.sp
$ fedfs-create-replication -h fs.example.net -l nsdb.example.net \\
	/export/replication1 `uuidgen -t`
.sp
.RE
In this example, a new UUID is created on the spot.
It can be read back from the server using the
.BR fedfs-lookup-replication (8)
command.
.SH SECURITY
By default, or if the
.B sys
and
.B unix
flavors are specified with the
.BI \-\-security= flavor
option, the
.BR fedfs-create-replication (8)
command uses AUTH_SYS security for the Remote Procedure Call.
AUTH_SYS has known weaknesses and should be avoided on untrusted networks.
.P
The RPC client uses the Kerberos v5 GSS mechanism
if a Kerberos security flavor is specified.
When specifying a Kerberos security flavor,
the user must first obtain a valid Kerberos ticket using
.BR kinit (1)
before running
.BR fedfs-create-replication (8).
.P
The AUTH_NONE security flavor is no longer supported by this implementation.
.SH "SEE ALSO"
.BR fedfs (7),
.BR rpc.fedfsd (8),
.BR fedfs-lookup-replication (8),
.BR nsdb-create-fsn (8),
.BR kinit (1),
.BR rpc (3t)
.sp
RFC 5716 for FedFS requirements and overview
.SH COLOPHON
This page is part of the fedfs-utils package.
A description of the project and information about reporting bugs
can be found at
.IR http://wiki.linux-nfs.org/wiki/index.php/FedFsUtilsProject .
.SH "AUTHOR"
Chuck Lever <chuck.lever@oracle.com>
